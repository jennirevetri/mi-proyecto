<div class="container">
  <div class="columns">
    <!-- Formulario: Selección y carga de archivos -->
    <div class="column is-half form-column">
      <h2 class="title is-4">Subir Archivo</h2>

      <!-- Selector principal de tipo de archivo -->
      <div class="field">
        <label class="label" for="fileType">Tipo de Archivo:</label>
        <div class="control">
          <div class="select is-fullwidth">
            <select (change)="updateFileType($event)">
              <option value="audio">Audio</option>
              <option value="image">Imagen</option>
              <option value="video">Video</option>
              <option value="pdf">PDF</option>
              <option value="subtitles">Subtítulos</option>
              <option value="wysiwyg">Términos y Condiciones</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Selector adicional para audios -->
      <div class="field" *ngIf="fileType === 'audio'">
        <label class="label" for="audioType">Seleccione Transiciones:</label>
        <div class="control">
          <div class="select is-fullwidth">
            <select id="audioType" [(ngModel)]="audioType">
              <option value="transition1">Transición 1</option>
              <option value="transition2">Transición 2</option>
              <option value="transition3">Transición 3</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Campo para seleccionar archivos -->
      <div class="field">
        <div class="file is-info">
          <label class="file-label">
            <input 
              class="file-input" 
              type="file" 
              id="fileInput" 
              (change)="handleFileUpload($event)" 
              [multiple]="fileType !== 'wysiwyg' && fileType !== 'subtitles'">
            <span class="file-cta">
              <span class="file-icon">
                <i class="fas fa-upload"></i>
              </span>
              <span class="file-label">Seleccionar archivo(s)</span>
            </span>
          </label>
        </div>
      </div>

      

      <!-- Editor WYSIWYG -->
      <div class="field" *ngIf="fileType === 'wysiwyg'">
        <label class="label">Términos y Condiciones</label>
        <quill-editor 
          [(ngModel)]="editorContent" 
          [modules]="editorConfig"
          [styles]="{ height: '200px' }">
        </quill-editor>
      </div>

      <!-- Botón para guardar archivos -->
      <div class="field">
        <button class="button is-primary" (click)="saveFiles()">Guardar</button>
      </div>

      <div *ngIf="uploadSuccess" class="notification is-success">
        ¡Archivo cargado con éxito!
      </div>
    </div>

    <!-- Vista previa -->
    <div class="column is-half preview">
      <h2 class="title is-4">Vista Previa</h2>
    
      <!-- Vista previa para audios -->
      <div *ngIf="fileType === 'audio'">
        <h3 class="subtitle is-5">Audios Seleccionados ({{ audioType }})</h3>
        <ul>
          <li *ngFor="let audio of audioFiles[audioType]">
            <p><strong>{{ audio.fileName }}</strong></p>
            <audio controls [src]="audio.fileUrl"></audio>
            <button class="button is-danger is-small" (click)="removeFile(audio, 'audio', audioType)">Eliminar</button>
          </li>
        </ul>
      </div>
    
      <!-- Vista previa para imágenes -->
      <div *ngIf="fileType === 'image'">
        <h3 class="subtitle is-5">Imágenes Seleccionadas</h3>
        <ul>
          <li *ngFor="let image of imageFiles">
            <img [src]="image.fileUrl" alt="{{ image.fileName }}" width="150">
            <p>{{ image.fileName }}</p>
            <button class="button is-danger is-small" (click)="removeFile(image, 'image')">Eliminar</button>
          </li>
        </ul>
      </div>
    
      <!-- Vista previa para videos -->
      <div *ngIf="fileType === 'video'">
        <h3 class="subtitle is-5">Videos Seleccionados</h3>
        <ul>
          <li *ngFor="let video of videoFiles">
            <video width="200" controls>
              <source [src]="video.fileUrl" type="video/mp4">
              Tu navegador no soporta el formato de video.
            </video>
            <p>{{ video.fileName }}</p>
            <button class="button is-danger is-small" (click)="removeFile(video, 'video')">Eliminar</button>
          </li>
        </ul>
      </div>
    
      <!-- Vista previa para PDFs -->
      <div *ngIf="fileType === 'pdf'">
        <h3 class="subtitle is-5">Archivos PDF Seleccionados</h3>
        <ul>
          <li *ngFor="let pdf of pdfFiles">
            <p>{{ pdf.fileName }}</p>
            <a [href]="pdf.fileUrl" target="_blank">Ver PDF</a>
            <button class="button is-danger is-small" (click)="removeFile(pdf, 'pdf')">Eliminar</button>
          </li>
        </ul>
      </div>
    
      <!-- Vista previa para subtítulos -->
      <div *ngIf="fileType === 'subtitles'">
        <h3 class="subtitle is-5">Subtítulos Seleccionados</h3>
        <ul>
          <li *ngFor="let subtitle of subtitleFiles">
            <p>{{ subtitle.fileName }}</p>
            <a [href]="subtitle.fileUrl" target="_blank">Ver Subtítulo</a>
            <button class="button is-danger is-small" (click)="removeFile(subtitle, 'subtitles')">Eliminar</button>
          </li>
        </ul>
      </div>

      <!-- Vista previa para texto WYSIWYG -->
      <!-- WYSIWYG Preview -->
      <div *ngIf="fileType === 'wysiwyg'">
        <h3 class="subtitle is-5">Terms and Conditions</h3>
        <div class="content" [innerHTML]="wysiwygText"></div>
        <button class="button is-danger is-small" (click)="removeFile({fileName: 'terms_and_conditions.html', fileUrl: '', fileType: 'wysiwyg'}, 'wysiwyg')">Remove Content</button>
      </div>
    </div>
  </div>
</div>